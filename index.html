<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arabic Alphabet Learning Tool</title>
    
    <!-- Simplified favicon for better compatibility -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23228B22'/%3E%3Ctext x='50' y='70' font-family='Arial' font-size='60' font-weight='bold' text-anchor='middle' fill='white'%3E%D8%A7%3C/text%3E%3C/svg%3E">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' rx='40' fill='%23228B22'/%3E%3Ctext x='90' y='130' font-family='Arial' font-size='100' font-weight='bold' text-anchor='middle' fill='white'%3E%D8%A7%3C/text%3E%3C/svg%3E">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="data:application/json,%7B%22name%22%3A%22Arabic%20Alphabet%22%2C%22short_name%22%3A%22Arabic%22%2C%22start_url%22%3A%22./%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23228B22%22%2C%22theme_color%22%3A%22%23228B22%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage/svg%2Bxml%2C%253Csvg%2520xmlns%253D'http%253A//www.w3.org/2000/svg'%2520viewBox%253D'0%25200%2520192%2520192'%253E%253Crect%2520width%253D'192'%2520height%253D'192'%2520rx%253D'40'%2520fill%253D'%252523228B22'/%253E%253Ctext%2520x%253D'96'%2520y%253D'140'%2520font-family%253D'Arial'%2520font-size%253D'120'%2520font-weight%253D'bold'%2520text-anchor%253D'middle'%2520fill%253D'white'%253E%25D8%25A7%253C/text%253E%253C/svg%253E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image/svg%2Bxml%22%7D%5D%7D">

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #9e0303 0%, #c42e2e 50%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior: none;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .alphabet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            direction: rtl;
        }
        
        .letter-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            direction: ltr;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            position: relative;
            overflow: hidden;
        }
        
        .letter-card:hover {
            transform: translateY(-5px);
            border-color: #9e0303;
            box-shadow: 0 8px 20px rgba(158, 3, 3, 0.3);
        }
        
        .letter-card.active {
            background: #9e0303;
            color: white;
            border-color: #9e0303;
        }
        
        .letter-card.expanded {
            grid-column: span 2;
            min-height: 180px;
            z-index: 10;
        }
        
        .arabic-letter {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 8px;
            font-family: 'Times New Roman', serif;
            line-height: 1;
        }
        
        .letter-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .letter-card.active .letter-name {
            color: white;
        }
        
        .transliteration {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
            margin-bottom: 5px;
        }
        
        .letter-card.active .transliteration {
            color: #f0f0f0;
        }
        
        .forms-container {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.3);
        }
        
        .letter-card.expanded .forms-container {
            display: block;
        }
        
        .forms-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .form-item {
            text-align: center;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }
        
        .letter-card.active .form-item {
            background: rgba(255,255,255,0.2);
        }
        
        .form-arabic {
            font-size: 1.8em;
            font-family: 'Times New Roman', serif;
            margin-bottom: 3px;
            color: inherit;
        }
        
        .form-label {
            font-size: 0.7em;
            opacity: 0.8;
            font-weight: bold;
        }
        
        .audio-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: inherit;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .audio-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .controls {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .control-btn {
            background: #9e0303;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s;
        }
        
        .control-btn:hover {
            background: #7a0202;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
                margin: 5px;
                border-radius: 20px;
            }
            
            h1 {
                font-size: 2.2em;
                margin-bottom: 25px;
            }
            
            .alphabet-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
            
            .letter-card {
                padding: 12px 8px;
                border-radius: 15px;
                min-height: 100px;
            }
            
            .letter-card.expanded {
                grid-column: span 3;
                min-height: 200px;
            }
            
            .arabic-letter {
                font-size: 2.2em;
                margin-bottom: 5px;
            }
            
            .letter-name {
                font-size: 0.95em;
                margin-bottom: 3px;
            }
            
            .transliteration {
                font-size: 0.85em;
            }
            
            .forms-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .form-arabic {
                font-size: 1.5em;
            }
            
            .control-btn {
                padding: 12px 18px;
                margin: 5px;
                font-size: 0.95em;
                min-width: 120px;
            }
        }
        
        @media (max-width: 450px) {
            .container {
                padding: 15px;
                margin: 0;
                border-radius: 15px;
            }
            
            h1 {
                font-size: 2em;
                margin-bottom: 20px;
            }
            
            .alphabet-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .letter-card {
                padding: 10px 6px;
                min-height: 90px;
            }
            
            .letter-card.expanded {
                grid-column: span 2;
                min-height: 180px;
            }
            
            .arabic-letter {
                font-size: 2em;
            }
            
            .letter-name {
                font-size: 0.9em;
            }
            
            .transliteration {
                font-size: 0.8em;
            }
        }
        
        /* PWA and Standalone App Styles */
        @media (display-mode: standalone) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
            }
        }
        
        /* Touch improvements for mobile */
        @media (hover: none) and (pointer: coarse) {
            .letter-card {
                transition: transform 0.2s ease, background-color 0.2s ease;
            }
            
            .letter-card:active {
                transform: scale(0.98);
            }
            
            .control-btn:active {
                transform: scale(0.95);
                background-color: #7a0202;
            }
        }
        
        /* Disable text selection and context menus */
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Allow text selection only where needed */
        .letter-name, .transliteration, h1 {
            -webkit-user-select: text;
            -moz-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ•Œ Arabic Alphabet Learning Tool</h1>
        
        <div class="controls">
            <button class="control-btn" onclick="collapseAll()">ğŸ“‹ Collapse All</button>
            <button class="control-btn" onclick="shuffleOrder()">ğŸ”€ Random Order</button>
            <button class="control-btn" onclick="resetOrder()">â†©ï¸ Reset Order</button>
        </div>
        
        <div class="alphabet-grid" id="alphabetGrid">
            <!-- Letters will be populated by JavaScript -->
        </div>
    </div>

    <script>
        const arabicLetters = [
            {
                letter: 'Ø§', name: 'Alif', transliteration: 'Ä', sound: 'alif',
                forms: { isolated: 'Ø§', initial: 'Ø§', middle: 'Ù€Ø§', final: 'Ù€Ø§' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'Ø¨', name: 'BÄÊ¾', transliteration: 'b', sound: 'baa',
                forms: { isolated: 'Ø¨', initial: 'Ø¨Ù€', middle: 'Ù€Ø¨Ù€', final: 'Ù€Ø¨' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Øª', name: 'TÄÊ¾', transliteration: 't', sound: 'taa',
                forms: { isolated: 'Øª', initial: 'ØªÙ€', middle: 'Ù€ØªÙ€', final: 'Ù€Øª' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø«', name: 'ThÄÊ¾', transliteration: 'th', sound: 'thaa',
                forms: { isolated: 'Ø«', initial: 'Ø«Ù€', middle: 'Ù€Ø«Ù€', final: 'Ù€Ø«' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø¬', name: 'JÄ«m', transliteration: 'j', sound: 'jeem',
                forms: { isolated: 'Ø¬', initial: 'Ø¬Ù€', middle: 'Ù€Ø¬Ù€', final: 'Ù€Ø¬' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø­', name: 'á¸¤ÄÊ¾', transliteration: 'á¸¥', sound: 'haa',
                forms: { isolated: 'Ø­', initial: 'Ø­Ù€', middle: 'Ù€Ø­Ù€', final: 'Ù€Ø­' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø®', name: 'KhÄÊ¾', transliteration: 'kh', sound: 'khaa',
                forms: { isolated: 'Ø®', initial: 'Ø®Ù€', middle: 'Ù€Ø®Ù€', final: 'Ù€Ø®' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø¯', name: 'DÄl', transliteration: 'd', sound: 'dal',
                forms: { isolated: 'Ø¯', initial: 'Ø¯', middle: 'Ù€Ø¯', final: 'Ù€Ø¯' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'Ø°', name: 'DhÄl', transliteration: 'dh', sound: 'thal',
                forms: { isolated: 'Ø°', initial: 'Ø°', middle: 'Ù€Ø°', final: 'Ù€Ø°' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'Ø±', name: 'RÄÊ¾', transliteration: 'r', sound: 'raa',
                forms: { isolated: 'Ø±', initial: 'Ø±', middle: 'Ù€Ø±', final: 'Ù€Ø±' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'Ø²', name: 'Zayn', transliteration: 'z', sound: 'zayn',
                forms: { isolated: 'Ø²', initial: 'Ø²', middle: 'Ù€Ø²', final: 'Ù€Ø²' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'Ø³', name: 'SÄ«n', transliteration: 's', sound: 'seen',
                forms: { isolated: 'Ø³', initial: 'Ø³Ù€', middle: 'Ù€Ø³Ù€', final: 'Ù€Ø³' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø´', name: 'ShÄ«n', transliteration: 'sh', sound: 'sheen',
                forms: { isolated: 'Ø´', initial: 'Ø´Ù€', middle: 'Ù€Ø´Ù€', final: 'Ù€Ø´' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Øµ', name: 'á¹¢Äd', transliteration: 'á¹£', sound: 'saad',
                forms: { isolated: 'Øµ', initial: 'ØµÙ€', middle: 'Ù€ØµÙ€', final: 'Ù€Øµ' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø¶', name: 'á¸ŒÄd', transliteration: 'á¸', sound: 'daad',
                forms: { isolated: 'Ø¶', initial: 'Ø¶Ù€', middle: 'Ù€Ø¶Ù€', final: 'Ù€Ø¶' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø·', name: 'á¹¬ÄÊ¾', transliteration: 'á¹­', sound: 'taa_emphatic',
                forms: { isolated: 'Ø·', initial: 'Ø·Ù€', middle: 'Ù€Ø·Ù€', final: 'Ù€Ø·' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø¸', name: 'áº’ÄÊ¾', transliteration: 'áº“', sound: 'zaa',
                forms: { isolated: 'Ø¸', initial: 'Ø¸Ù€', middle: 'Ù€Ø¸Ù€', final: 'Ù€Ø¸' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ø¹', name: 'Ê¿Ayn', transliteration: 'Ê¿', sound: 'ayn',
                forms: { isolated: 'Ø¹', initial: 'Ø¹Ù€', middle: 'Ù€Ø¹Ù€', final: 'Ù€Ø¹' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Øº', name: 'Ghayn', transliteration: 'gh', sound: 'ghayn',
                forms: { isolated: 'Øº', initial: 'ØºÙ€', middle: 'Ù€ØºÙ€', final: 'Ù€Øº' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ù', name: 'FÄÊ¾', transliteration: 'f', sound: 'faa',
                forms: { isolated: 'Ù', initial: 'ÙÙ€', middle: 'Ù€ÙÙ€', final: 'Ù€Ù' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ù‚', name: 'QÄf', transliteration: 'q', sound: 'qaaf',
                forms: { isolated: 'Ù‚', initial: 'Ù‚Ù€', middle: 'Ù€Ù‚Ù€', final: 'Ù€Ù‚' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ùƒ', name: 'KÄf', transliteration: 'k', sound: 'kaaf',
                forms: { isolated: 'Ùƒ', initial: 'ÙƒÙ€', middle: 'Ù€ÙƒÙ€', final: 'Ù€Ùƒ' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ù„', name: 'LÄm', transliteration: 'l', sound: 'laam',
                forms: { isolated: 'Ù„', initial: 'Ù„Ù€', middle: 'Ù€Ù„Ù€', final: 'Ù€Ù„' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ù…', name: 'MÄ«m', transliteration: 'm', sound: 'meem',
                forms: { isolated: 'Ù…', initial: 'Ù…Ù€', middle: 'Ù€Ù…Ù€', final: 'Ù€Ù…' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ù†', name: 'NÅ«n', transliteration: 'n', sound: 'noon',
                forms: { isolated: 'Ù†', initial: 'Ù†Ù€', middle: 'Ù€Ù†Ù€', final: 'Ù€Ù†' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ù‡', name: 'HÄÊ¾', transliteration: 'h', sound: 'haa_final',
                forms: { isolated: 'Ù‡', initial: 'Ù‡Ù€', middle: 'Ù€Ù‡Ù€', final: 'Ù€Ù‡' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'Ùˆ', name: 'WÄw', transliteration: 'w/Å«', sound: 'waaw',
                forms: { isolated: 'Ùˆ', initial: 'Ùˆ', middle: 'Ù€Ùˆ', final: 'Ù€Ùˆ' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'ÙŠ', name: 'YÄÊ¾', transliteration: 'y/Ä«', sound: 'yaa',
                forms: { isolated: 'ÙŠ', initial: 'ÙŠÙ€', middle: 'Ù€ÙŠÙ€', final: 'Ù€ÙŠ' },
                connects: { initial: true, final: true }
            }
        ];

        let currentLetters = [...arabicLetters];
        let expandedCard = null;

        function createLetterCard(letterData, index) {
            const formsHtml = `
                <div class="forms-container">
                    <div class="forms-grid">
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.isolated}</div>
                            <div class="form-label">Isolated</div>
                        </div>
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.initial}</div>
                            <div class="form-label">Initial</div>
                        </div>
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.middle}</div>
                            <div class="form-label">Middle</div>
                        </div>
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.final}</div>
                            <div class="form-label">Final</div>
                        </div>
                    </div>
                    <button class="audio-btn" onclick="playSound('${letterData.sound}', event)">ğŸ”Š Play Sound</button>
                </div>
            `;
            
            return `
                <div class="letter-card" onclick="toggleCard(${index})" data-sound="${letterData.sound}">
                    <div class="arabic-letter">${letterData.letter}</div>
                 