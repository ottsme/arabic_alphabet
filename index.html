<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arabic Alphabet Learning Tool</title>
    
    <!-- Simplified favicon for better compatibility -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23228B22'/%3E%3Ctext x='50' y='70' font-family='Arial' font-size='60' font-weight='bold' text-anchor='middle' fill='white'%3E%D8%A7%3C/text%3E%3C/svg%3E">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' rx='40' fill='%23228B22'/%3E%3Ctext x='90' y='130' font-family='Arial' font-size='100' font-weight='bold' text-anchor='middle' fill='white'%3E%D8%A7%3C/text%3E%3C/svg%3E">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="data:application/json,%7B%22name%22%3A%22Arabic%20Alphabet%22%2C%22short_name%22%3A%22Arabic%22%2C%22start_url%22%3A%22./%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23228B22%22%2C%22theme_color%22%3A%22%23228B22%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage/svg%2Bxml%2C%253Csvg%2520xmlns%253D'http%253A//www.w3.org/2000/svg'%2520viewBox%253D'0%25200%2520192%2520192'%253E%253Crect%2520width%253D'192'%2520height%253D'192'%2520rx%253D'40'%2520fill%253D'%252523228B22'/%253E%253Ctext%2520x%253D'96'%2520y%253D'140'%2520font-family%253D'Arial'%2520font-size%253D'120'%2520font-weight%253D'bold'%2520text-anchor%253D'middle'%2520fill%253D'white'%253E%25D8%25A7%253C/text%253E%253C/svg%253E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image/svg%2Bxml%22%7D%5D%7D">

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #9e0303 0%, #c42e2e 50%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior: none;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .alphabet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            direction: rtl;
        }
        
        .letter-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            direction: ltr;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            position: relative;
            overflow: hidden;
        }
        
        .letter-card:hover {
            transform: translateY(-5px);
            border-color: #9e0303;
            box-shadow: 0 8px 20px rgba(158, 3, 3, 0.3);
        }
        
        .letter-card.active {
            background: #9e0303;
            color: white;
            border-color: #9e0303;
        }
        
        .letter-card.expanded {
            grid-column: span 2;
            min-height: 180px;
            z-index: 10;
        }
        
        .arabic-letter {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 8px;
            font-family: 'Times New Roman', serif;
            line-height: 1;
        }
        
        .letter-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .letter-card.active .letter-name {
            color: white;
        }
        
        .transliteration {
            font-size: 0.9em;
            color: #666;
            font-style: italic;
            margin-bottom: 5px;
        }
        
        .letter-card.active .transliteration {
            color: #f0f0f0;
        }
        
        .forms-container {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.3);
        }
        
        .letter-card.expanded .forms-container {
            display: block;
        }
        
        .forms-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .form-item {
            text-align: center;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }
        
        .letter-card.active .form-item {
            background: rgba(255,255,255,0.2);
        }
        
        .form-arabic {
            font-size: 1.8em;
            font-family: 'Times New Roman', serif;
            margin-bottom: 3px;
            color: inherit;
        }
        
        .form-label {
            font-size: 0.7em;
            opacity: 0.8;
            font-weight: bold;
        }
        
        .audio-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: inherit;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .audio-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .controls {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .control-btn {
            background: #9e0303;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s;
        }
        
        .control-btn:hover {
            background: #7a0202;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
                margin: 5px;
                border-radius: 20px;
            }
            
            h1 {
                font-size: 2.2em;
                margin-bottom: 25px;
            }
            
            .alphabet-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
            
            .letter-card {
                padding: 12px 8px;
                border-radius: 15px;
                min-height: 100px;
            }
            
            .letter-card.expanded {
                grid-column: span 3;
                min-height: 200px;
            }
            
            .arabic-letter {
                font-size: 2.2em;
                margin-bottom: 5px;
            }
            
            .letter-name {
                font-size: 0.95em;
                margin-bottom: 3px;
            }
            
            .transliteration {
                font-size: 0.85em;
            }
            
            .forms-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .form-arabic {
                font-size: 1.5em;
            }
            
            .control-btn {
                padding: 12px 18px;
                margin: 5px;
                font-size: 0.95em;
                min-width: 120px;
            }
        }
        
        @media (max-width: 450px) {
            .container {
                padding: 15px;
                margin: 0;
                border-radius: 15px;
            }
            
            h1 {
                font-size: 2em;
                margin-bottom: 20px;
            }
            
            .alphabet-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .letter-card {
                padding: 10px 6px;
                min-height: 90px;
            }
            
            .letter-card.expanded {
                grid-column: span 2;
                min-height: 180px;
            }
            
            .arabic-letter {
                font-size: 2em;
            }
            
            .letter-name {
                font-size: 0.9em;
            }
            
            .transliteration {
                font-size: 0.8em;
            }
        }
        
        /* PWA and Standalone App Styles */
        @media (display-mode: standalone) {
            body {
                padding-top: env(safe-area-inset-top);
                padding-bottom: env(safe-area-inset-bottom);
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
            }
        }
        
        /* Touch improvements for mobile */
        @media (hover: none) and (pointer: coarse) {
            .letter-card {
                transition: transform 0.2s ease, background-color 0.2s ease;
            }
            
            .letter-card:active {
                transform: scale(0.98);
            }
            
            .control-btn:active {
                transform: scale(0.95);
                background-color: #7a0202;
            }
        }
        
        /* Disable text selection and context menus */
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Allow text selection only where needed */
        .letter-name, .transliteration, h1 {
            -webkit-user-select: text;
            -moz-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🕌 Arabic Alphabet Learning Tool</h1>
        
        <div class="controls">
            <button class="control-btn" onclick="collapseAll()">📋 Collapse All</button>
            <button class="control-btn" onclick="shuffleOrder()">🔀 Random Order</button>
            <button class="control-btn" onclick="resetOrder()">↩️ Reset Order</button>
        </div>
        
        <div class="alphabet-grid" id="alphabetGrid">
            <!-- Letters will be populated by JavaScript -->
        </div>
    </div>

    <script>
        const arabicLetters = [
            {
                letter: 'ا', name: 'Alif', transliteration: 'ā', sound: 'alif',
                forms: { isolated: 'ا', initial: 'ا', middle: 'ـا', final: 'ـا' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'ب', name: 'Bāʾ', transliteration: 'b', sound: 'baa',
                forms: { isolated: 'ب', initial: 'بـ', middle: 'ـبـ', final: 'ـب' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ت', name: 'Tāʾ', transliteration: 't', sound: 'taa',
                forms: { isolated: 'ت', initial: 'تـ', middle: 'ـتـ', final: 'ـت' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ث', name: 'Thāʾ', transliteration: 'th', sound: 'thaa',
                forms: { isolated: 'ث', initial: 'ثـ', middle: 'ـثـ', final: 'ـث' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ج', name: 'Jīm', transliteration: 'j', sound: 'jeem',
                forms: { isolated: 'ج', initial: 'جـ', middle: 'ـجـ', final: 'ـج' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ح', name: 'Ḥāʾ', transliteration: 'ḥ', sound: 'haa',
                forms: { isolated: 'ح', initial: 'حـ', middle: 'ـحـ', final: 'ـح' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'خ', name: 'Khāʾ', transliteration: 'kh', sound: 'khaa',
                forms: { isolated: 'خ', initial: 'خـ', middle: 'ـخـ', final: 'ـخ' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'د', name: 'Dāl', transliteration: 'd', sound: 'dal',
                forms: { isolated: 'د', initial: 'د', middle: 'ـد', final: 'ـد' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'ذ', name: 'Dhāl', transliteration: 'dh', sound: 'thal',
                forms: { isolated: 'ذ', initial: 'ذ', middle: 'ـذ', final: 'ـذ' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'ر', name: 'Rāʾ', transliteration: 'r', sound: 'raa',
                forms: { isolated: 'ر', initial: 'ر', middle: 'ـر', final: 'ـر' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'ز', name: 'Zayn', transliteration: 'z', sound: 'zayn',
                forms: { isolated: 'ز', initial: 'ز', middle: 'ـز', final: 'ـز' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'س', name: 'Sīn', transliteration: 's', sound: 'seen',
                forms: { isolated: 'س', initial: 'سـ', middle: 'ـسـ', final: 'ـس' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ش', name: 'Shīn', transliteration: 'sh', sound: 'sheen',
                forms: { isolated: 'ش', initial: 'شـ', middle: 'ـشـ', final: 'ـش' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ص', name: 'Ṣād', transliteration: 'ṣ', sound: 'saad',
                forms: { isolated: 'ص', initial: 'صـ', middle: 'ـصـ', final: 'ـص' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ض', name: 'Ḍād', transliteration: 'ḍ', sound: 'daad',
                forms: { isolated: 'ض', initial: 'ضـ', middle: 'ـضـ', final: 'ـض' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ط', name: 'Ṭāʾ', transliteration: 'ṭ', sound: 'taa_emphatic',
                forms: { isolated: 'ط', initial: 'طـ', middle: 'ـطـ', final: 'ـط' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ظ', name: 'Ẓāʾ', transliteration: 'ẓ', sound: 'zaa',
                forms: { isolated: 'ظ', initial: 'ظـ', middle: 'ـظـ', final: 'ـظ' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ع', name: 'ʿAyn', transliteration: 'ʿ', sound: 'ayn',
                forms: { isolated: 'ع', initial: 'عـ', middle: 'ـعـ', final: 'ـع' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'غ', name: 'Ghayn', transliteration: 'gh', sound: 'ghayn',
                forms: { isolated: 'غ', initial: 'غـ', middle: 'ـغـ', final: 'ـغ' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ف', name: 'Fāʾ', transliteration: 'f', sound: 'faa',
                forms: { isolated: 'ف', initial: 'فـ', middle: 'ـفـ', final: 'ـف' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ق', name: 'Qāf', transliteration: 'q', sound: 'qaaf',
                forms: { isolated: 'ق', initial: 'قـ', middle: 'ـقـ', final: 'ـق' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ك', name: 'Kāf', transliteration: 'k', sound: 'kaaf',
                forms: { isolated: 'ك', initial: 'كـ', middle: 'ـكـ', final: 'ـك' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ل', name: 'Lām', transliteration: 'l', sound: 'laam',
                forms: { isolated: 'ل', initial: 'لـ', middle: 'ـلـ', final: 'ـل' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'م', name: 'Mīm', transliteration: 'm', sound: 'meem',
                forms: { isolated: 'م', initial: 'مـ', middle: 'ـمـ', final: 'ـم' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ن', name: 'Nūn', transliteration: 'n', sound: 'noon',
                forms: { isolated: 'ن', initial: 'نـ', middle: 'ـنـ', final: 'ـن' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'ه', name: 'Hāʾ', transliteration: 'h', sound: 'haa_final',
                forms: { isolated: 'ه', initial: 'هـ', middle: 'ـهـ', final: 'ـه' },
                connects: { initial: true, final: true }
            },
            {
                letter: 'و', name: 'Wāw', transliteration: 'w/ū', sound: 'waaw',
                forms: { isolated: 'و', initial: 'و', middle: 'ـو', final: 'ـو' },
                connects: { initial: false, final: true }
            },
            {
                letter: 'ي', name: 'Yāʾ', transliteration: 'y/ī', sound: 'yaa',
                forms: { isolated: 'ي', initial: 'يـ', middle: 'ـيـ', final: 'ـي' },
                connects: { initial: true, final: true }
            }
        ];

        let currentLetters = [...arabicLetters];
        let expandedCard = null;

        function createLetterCard(letterData, index) {
            const formsHtml = `
                <div class="forms-container">
                    <div class="forms-grid">
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.isolated}</div>
                            <div class="form-label">Isolated</div>
                        </div>
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.initial}</div>
                            <div class="form-label">Initial</div>
                        </div>
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.middle}</div>
                            <div class="form-label">Middle</div>
                        </div>
                        <div class="form-item">
                            <div class="form-arabic">${letterData.forms.final}</div>
                            <div class="form-label">Final</div>
                        </div>
                    </div>
                    <button class="audio-btn" onclick="playSound('${letterData.sound}', event)">🔊 Play Sound</button>
                </div>
            `;
            
            return `
                <div class="letter-card" onclick="toggleCard(${index})" data-sound="${letterData.sound}">
                    <div class="arabic-letter">${letterData.letter}</div>
                 